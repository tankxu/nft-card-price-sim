# ANOME NFT 卡牌池模拟器

纯前端实现的卡牌池价格模型，重点在迭代算法和指标回显。

## 核心算法

1. **状态初始化**  
   `S = S₀`, `U = S × P₀`，先记录 `(steps=0, P₀)`。

2. **原子操作**  
   - 买：`U += U/S`，并把单价累计到 `buyCost`。  
   - 卖：`U -= (1 - fee) × (U/S)`，下限为 0。  
   - 烧：`S > 1` 时按照当前价格 `U/S` 先扣除 `(1 - retain) × U/S`（retain 默认为 0.4，可配置），再 `S -= 1`，并把实际扣减额累计到 `burnPriceSum`。

3. **批处理与采样**  
   - `stepSize` 确定每步最多处理的张数；开启“100%渲染”时每张都 push 记录，否则一批 push 一次。  
   - 每次记录都会把本段操作类型塞进 `segmentOps`，供 Chart.js 给线段着色。

4. **执行顺序**  
   输入顺序字符串拆成 `buy/sell/burn` 三类依次执行；烧卡会根据当前 `S` 自动截断，保证 `S ≥ 1`。

5. **指标计算**  
   - 最终价格 `P = U / S`，并对比初始价格给出涨跌百分比。  
   - 简易校验：`S_simple = S₀ - 卖出张数 - 销毁张数`，与模拟得到的 `S` 做一致性检查。  
   - 销毁平均价 = `burnPriceSum / burnCount`；总销毁金额 = `burnPriceSum`；若有买入成本则计算 `burnPriceSum / buyCost` 的比例。

## 结果展示

- “有效参数”面板分两列显示输入/执行结果（S₀、P₀、U₀、买卖烧数量、最终 S、校验状态）。  
- 三个 pill 分别给出价格变化、销毁均价、销毁总金额（附销毁/买入比例）。  
- 折线图使用 Chart.js，线段颜色随操作切换（买=蓝、卖=黄、烧=红），高密度模式下可以贴合每一张卡的价格轨迹。
